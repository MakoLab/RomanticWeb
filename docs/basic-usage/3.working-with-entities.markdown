---
layout: tutorial
title:  "Working with entities"
permalink: 'entities/'
prev: 'docs/basic-usage/context-factory/'
next: 'docs/basic-usage/rdf-types/'
categories: ['docs', 'basic-usage']
---

# Create entity context

Now that we have a entity context factory created in the previous step it is time to create an entity context. It is as
simple as calling one method.

{% highlight java linenos=table %}
var context = contextFactory.CreateContext();
{% endhighlight %}

## Creating entities

We are now ready to start creating some data. Here's how we create a new entity and populate it with some data

{% highlight java linenos=table %}
// create an entity
var tim = context.Create<IPerson>(new Uri("Tim-Berners-Lee"));

// set some properties
tim.Name = "Tim";
tim.LastName = "Berners-Lee";

// commit data to store
context.Commit();
{% endhighlight %}

This will create some triples describing sir Tim Berners-Lee (assuming mappings from the previous page)

{% highlight css linenos=table %}
<Tim-Berners-Lee>
    foaf:givenName "Tim" ;
    foaf:LastName "Berners-Lee" .
{% endhighlight %}

You may notice that for simplicity relative URIs are used. This is totally supported by Romantic Web, but requires
configuration. Please read more on the [detailed page][factory-config] about entity context factory configuration.

## Loading entities

The entity context is also used to retrieve entities. Its interface exposes a generic `Load` method, which creates an
instance of the given entity type.

For example later on we may want to associate sir Tim Berners-Lee with another person we create.

{% highlight java linenos=table %}
var norman = context.Create<IPerson>(new Uri("Norman-Walsh"));
var tim = context.Load<IPerson>(new Uri("Tim-Berners-Lee"));

tim.Knows.Add(norman);

context.Commit();
{% endhighlight %}

This would assert the following triple in the store

{% highlight css linenos=table %}
<Tim-Berners-Lee> foaf:knows <Norman-Walsh> .
{% endhighlight %}

## Deleting entities

Lastly of course there is a `Delete` method, which removes all triples about a given entity. Because entity data is
partitioned in Named Graphs, deletion simply removes whole graphs. This means that there are no blank nodes orphaned if
the resource had any in its representation. The usage is a s simple as

{% highlight java linenos=table %}
EntityId identifier = new Uri("Tim-Berners-Lee");
context.Delete(identifier);
{% endhighlight %}

And if you have an entity instance you'd do

{% highlight java linenos=table %}
IPerson tim = //...
context.Delete(tim.Id);
{% endhighlight %}

## Transforming entities

One consequence of [open-world assumption][owa] is that each resource can be an instance of many types at the same time.
It poses a challenge to the statically typed languages like C# where an instance cannot change its type at will.

In Romantic Web each entity is a proxy to the underlying triples and it is possible to change the object from one type
to another without any restrictions on the types.

<ul class="nav nav-tabs" role="tablist">
  <li class="active"><a href="#usage" role="tab" data-toggle="tab">Usage</a></li>
  <li><a href="#person" role="tab" data-toggle="tab">Person entity</a></li>
  <li><a href="#employee" role="tab" data-toggle="tab">Employee entity</a></li>
  <li><a href="#triples" role="tab" data-toggle="tab">Result triples</a></li>
</ul>

<dd class="tab-content">
  <div class="tab-pane fade in active" id="usage">

{% highlight java linenos=table %}
using RomanticWeb;

IEntityContext context = // ...
Uri personUri = new Uri("http://example.org/ThePerson");

var person = context.Create<IPerson>(personUri);
person.Name = "John";
person.LastName = "Doe";

var employee = person.AsEntity<IEmployee>();
employee.Salary = 2000;
employee.EmployerName = "cool soft inc";

context.Commit();
{% endhighlight %}

  </div>
  <div class="tab-pane fade" id="person">

{% highlight java linenos=table %}
using RomanticWeb.Mapping.Attributes;
using RomanticWeb.Mapping.Model;

public interface IPerson : IEntity
{
    [Property("foaf", "givenName")]
    string Name { get; set; }

    [Property("foaf", "familyName")]
    string LastName { get; set; }
}
{% endhighlight %}

  </div>
  <div class="tab-pane fade" id="employee">

{% highlight java linenos=table %}
using RomanticWeb.Mapping.Attributes;
using RomanticWeb.Mapping.Model;

public interface IEmployee : IEntity
{
    [Property("ex", "salary")]
    int Salary { get; set; }

    [Property("ex", "employer")]
    string EmployerName { get; set; }
}
{% endhighlight %}

  </div>
  <div class="tab-pane fade" id="triples">

{% highlight css linenos=table %}

<http://example.org/ThePerson>
    foaf:givenName "John"^^xsd:string ;
    foaf:familyName "Doe"^^xsd:string ;
    ex:salary 2000 ;
    ex:employer "cool soft inc"^^xsd:string .

{% endhighlight %}

  </div>
</dd>

As the example shows, the resource representation contains all triples that are part of the person and employee
representations.

[foaf]: http://www.foaf-project.org/
[foaf-doc]: http://xmlns.com/foaf/spec/
[fnh]: http://www.fluentnhibernate.org/
[concepts]: ../../getting-started/concepts
[dnr]: http://dotnetrdf.org
[owa]: http://wiki.opensemanticframework.org/index.php/Overview_of_the_Open_World_Assumption
[factory-config]: ../../advanced-topics/factory-config/